#! /bin/sh
# (c) Copyright 2019-2023, James Stevens ... see LICENSE for details
# Alternative license arrangements possible, contact me for more information

if test "${PYRAR_PDNS_ONLY}" = "Y"
	then
		{
		echo "::respawn:/usr/sbin/syslogd -r -f /run/syslog.conf -n"
		echo "::respawn:/usr/local/bin/start_pdns"
		} > /run/inittab
		exit 0
	fi


{
echo "::respawn:/usr/sbin/syslogd -r -f /run/syslog.conf -n"

awk '{
	printf "::respawn:/usr/local/bin/start_wsgi_epprest 1 %s\n",$1
	}' /run/regs_ports

echo "
::respawn:/usr/local/bin/start_wsgi_webui
::respawn:/usr/local/bin/start_wsgi_admin
::respawn:/usr/local/bin/start_pdns
::respawn:/usr/local/bin/start_nginx
::respawn:/usr/local/bin/start_backend_runner
::respawn:/usr/local/bin/start_cardproc
::respawn:/usr/local/bin/start_spooler
::respawn:/usr/sbin/crond -f -c /etc/crontabs -l 9
::respawn:/usr/sbin/postfix start-fg >/tmp/postfix.log 2>&1
"
} > /run/inittab
